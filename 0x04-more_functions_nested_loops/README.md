functions and more on nested loop
